#!/usr/bin/env bash

conf="https://raw.githubusercontent.com/n-sweep/.dotfiles/refs/heads/main/nixos/modules/bootstrap_config.nix"
src="/tmp/configuration.nix"
dst="/etc/nixos/configuration.nix"

sudo -v
curl -o "$src" "$conf"

to_replace=$(rg 'system.stateVersion' "$src")
replacement_text=$(rg 'system.stateVersion' "$dst")
sed -i "s/$to_replace/c\\$replacement_text/" "$src"

sudo mv $src $dst
